<!DOCTYPE html>
<html lang="en" ng-app="WebPkiLocalDemoApp">
<head>
	<meta charset="UTF-8" />
	<title>Web PKI Local Signature Samples</title>
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/bootstrap-theme.css">
	<link rel="stylesheet" href="css/angular-block-ui.css">
	<link rel="stylesheet" href="css/site.css">
</head>
<body>

	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<a class="navbar-brand" href="/">Web PKI Local Signature Samples</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="dropdown">
						<a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false" onclick="return false">Local Signatures <span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
							<li><a href="signPdfView.html">Sign PDF</a></li>
							<li><a href="signCadesView.html">Sign CAdES</a></li>
							<li><a href="validatePadesView.html">Validate PAdES</a></li>
							<li><a href="validateCadesView.html">Validate CAdES</a></li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</nav>

    <div class="container">
        <h3>Validate PAdES signature (Web PKI Pro)</h3>
        <div ng-controller="padesValidateController">


            <div class="row">
                <div class="col-sm-12">
                    <p>
                        <label>Selecione um PDF assinado para abrir</label>
                    </p>
                </div>
            </div>

            <div class="row">
                <div class="col-xs-2">
                    <button type="button" class="btn btn-default" ng-click="selectFile()" ng-disabled="state != 'input'">
                        <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Selecionar
                    </button>
                </div>
                <div ng-show="signatureFile.id != null" class="col-xs-8">
                    <div>
                        <a href="" ng-click="openFile(signatureFile)">{{ signatureFile.name }}</a> ({{ getDisplaySize(signatureFile.length) }})
                    </div>
                </div>
            </div>
            <br />
            <div ng-show="signatureFile.id != null">
                <div class="row">
                    <div class="col-sm-12">
                        <p>
                            <input type="checkbox" id="validate" ng-model="validate" /> <label for="validate"><b>Validar</b></label><br />
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <p>
                            <button type="button" class="btn btn-primary btn-lg" ng-click="open()" ng-disabled="state != 'input'">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Abrir
                            </button>
                        </p>
                    </div>
                </div>
            </div>
            <br />

            <div class="row" ng-show="state == 'finished'">
                <div class="col-sm-12">
                    <br />
                    <label><h4>Assinaturas:</h4></label>
                    <br />
                    <div class="row" ng-repeat="signer in signers">

                        <div ng-class="{true: 'panel-danger', false: 'panel panel-default'}[signer.isValid === false]">
                            <div class="panel-heading">
                                <a class="alert-link" data-toggle="collapse" data-target="#collapse{{$index}}">{{ signer.certificate.subjectName }} - Assinatura <b>{{ signer.isValid === false ? 'inválida' : '' }} {{ signer.isValid === true ? 'válida' : '' }}</b></a>
                            </div>
                            <div id="collapse{{$index}}" class="panel-collapse collapse">

                                <div class="panel-body">
                                    <div class="row">
                                        <form class="form-horizontal" role="form">

                                            <div class="form-group">
                                                <label class="col-sm-2 control-label">Message Digest</label>
                                                <div class="col-sm-10">
                                                    <p class="form-control-static">{{'(' + signer.messageDigest.digestAlgorithmName + ') ' + signer.messageDigest.digestValue}}</p>
                                                </div>
                                            </div>

                                            <div class="form-group" ng-show="signer.signaturePolicy != null">
                                                <label class="col-sm-2 control-label">Policy OID</label>
                                                <div class="col-sm-10">
                                                    <p class="form-control-static">{{ signer.signaturePolicy.oid }}</p>
                                                </div>
                                            </div>

                                            <div class="form-group" ng-show="signer.signingTime != null">
                                                <label class="col-sm-2 control-label">Signing Date/time</label>
                                                <div class="col-sm-10">
                                                    <p class="form-control-static">{{ signer.signingTime | date : 'dd/MM/yyyy HH:mm:ss' }}</p>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div ng-show="signer.vr">
                                        Resultados da validação:
                                        <br /> <br />
                                        <textarea cols="150" rows="20">{{ signer.vr }}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <p>
                        <button type="button" class="btn btn-default" ng-click="reset()">
                            <span class="glyphicon glyphicon-fast-backward" aria-hidden="true"></span> Validar outra assinatura
                        </button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/angular.js"></script>
    <script src="js/ui-bootstrap-tpls.js"></script>
    <script src="js/angular-block-ui.js"></script>
    <script src="js/lacuna-web-pki-2.5.0-latest.js"></script>
    
    <script src="app/app.js"></script>
    <script src="app/padesValidateController.js"></script>
    <script src="app/dialogController.js"></script>

</body>
</html>